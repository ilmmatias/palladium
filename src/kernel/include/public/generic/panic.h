/* SPDX-FileCopyrightText: (C) 2025 ilmmatias
 * SPDX-License-Identifier: GPL-3.0-or-later */

#ifndef _GENERIC_PANIC_H_
#define _GENERIC_PANIC_H_

#include <stdint.h>

#ifdef ARCH_amd64
#include <amd64/panic.h>
#else
#error "Undefined ARCH for the kernel module!"
#endif /* ARCH */

#define KE_PANIC_MANUALLY_INITIATED_CRASH 0
#define KE_PANIC_IRQL_NOT_LESS_OR_EQUAL 1
#define KE_PANIC_IRQL_NOT_GREATER_OR_EQUAL 2
#define KE_PANIC_IRQL_NOT_DISPATCH 3
#define KE_PANIC_TRAP_NOT_HANDLED 4
#define KE_PANIC_EXCEPTION_NOT_HANDLED 5
#define KE_PANIC_PAGE_FAULT_NOT_HANDLED 6
#define KE_PANIC_NMI_HARDWARE_FAILURE 7
#define KE_PANIC_KERNEL_INITIALIZATION_FAILURE 8
#define KE_PANIC_DRIVER_INITIALIZATION_FAILURE 9
#define KE_PANIC_BAD_PFN_HEADER 10
#define KE_PANIC_BAD_POOL_HEADER 11
#define KE_PANIC_COUNT 12

#define KE_PANIC_PARAMETER_OUT_OF_RESOURCES 0x0000000000000000

#define KE_PANIC_PARAMETER_PFN_INITIALIZATION_FAILURE 0x0000000000000000
#define KE_PANIC_PARAMETER_POOL_INITIALIZATION_FAILURE 0x0000000000000001
#define KE_PANIC_PARAMETER_SCHEDULER_INITIALIZATION_FAILURE 0x0000000000000002
#define KE_PANIC_PARAMETER_ACPI_INITIALIZATION_FAILURE 0x0000000000000003
#define KE_PANIC_PARAMETER_DRIVER_INITIALIZATION_FAILURE 0x0000000000000004

#define KE_PANIC_PARAMETER_BAD_RSDT_TABLE 0x0000000000000000
#define KE_PANIC_PARAMETER_BAD_APIC_TABLE 0x0000000000000001
#define KE_PANIC_PARAMETER_BAD_HPET_TABLE 0x0000000000000002
#define KE_PANIC_PARAMETER_BAD_DSDT_TABLE 0x0000000000000003
#define KE_PANIC_PARAMETER_TABLE_NOT_FOUND 0x0000000000000001
#define KE_PANIC_PARAMETER_INVALID_TABLE_CHECKSUM 0x0000000000000002

#ifdef __cplusplus
extern "C" {
#endif /* __cplusplus */

[[noreturn]] void KeFatalError(
    uint32_t Message,
    uint64_t Parameter1,
    uint64_t Parameter2,
    uint64_t Parameter3,
    uint64_t Parameter4);

#ifdef __cplusplus
}
#endif /* __cplusplus */

#endif /* _GENERIC_PANIC_H_ */
